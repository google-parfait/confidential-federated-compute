--- MODULE.bazel
+++ MODULE.bazel
@@ -216,11 +216,11 @@
 git_repository(
     name = "libcppbor",
-    build_file = "@//:third_party/google/libcppbor/BUILD",
+    build_file = "//:third_party/google/libcppbor/BUILD",
     # Head commit on 202505-09
     commit = "b1b998be4ec447f3086e7fd6a7f78eaec66a1c45",
     patches = [
-        "@//:third_party/google/libcppbor/remove_macro.patch",
+        "//:third_party/google/libcppbor/remove_macro.patch",
-        "@//:third_party/google/libcppbor/limits.patch",
+        "//:third_party/google/libcppbor/limits.patch",
     ],
     remote = "https://android.googlesource.com/platform/external/libcppbor",
 )
@@ -228,3 +228,3 @@
 http_archive(
     name = "cose_lib",
-    build_file = "@//:third_party/BUILD.cose_lib",
+    build_file = "//:third_party/BUILD.cose_lib",
@@ -236,3 +236,3 @@
 http_archive(
     name = "e2fsprogs",
-    build_file = "@//:third_party/BUILD.e2fsprogs",
+    build_file = "//:third_party/BUILD.e2fsprogs",
@@ -203,6 +203,96 @@
 ##### Rust Toolchain Setup #####

 bazel_dep(name = "rules_shell", version = "0.5.0")
 bazel_dep(name = "rules_rust", version = "0.61.0")
 bazel_dep(name = "rules_rust_wasm_bindgen", version = "0.61.0")

+crate = use_extension("@rules_rust//crate_universe:extensions.bzl", "crate")
+crate.annotation(crate = "tokio", rustc_flags = ["--cfg=tokio_unstable"])
+crate.spec(package = "aead", version = "0.5.2")
+crate.spec(package = "aes-gcm", version = "0.10.3")
+crate.spec(package = "ahash", version = "0.8.11")
+crate.spec(package = "anyhow", version = "1.0.98")
+crate.spec(package = "async-trait", version = "0.1.81")
+crate.spec(package = "base64", version = "0.21.7")
+crate.spec(package = "bitflags", version = "2.9.1")
+crate.spec(package = "bytes", version = "1.10.1")
+crate.spec(package = "chrono", version = "0.4.42")
+crate.spec(package = "ciborium", version = "0.2.2")
+crate.spec(package = "coset", version = "0.3.7")
+crate.spec(package = "const-oid", version = "0.9.6")
+crate.spec(package = "derive_builder", version = "0.20.0")
+crate.spec(package = "ecdsa", version = "0.16.9")
+crate.spec(package = "futures", version = "0.3.31")
+crate.spec(package = "getrandom", version = "0.2.15")
+crate.spec(package = "getset", version = "0.1.6")
+crate.spec(package = "googletest", version = "0.11.0")
+crate.spec(package = "hashbrown", version = "0.14.5")
+crate.spec(package = "hex", version = "0.4.3")
+crate.spec(package = "hkdf", version = "0.12.4")
+crate.spec(package = "hpke", version = "0.11.0")
+crate.spec(package = "http", version = "1.3.1")
+crate.spec(package = "hyper-util", version = "0.1.16")
+crate.spec(package = "itertools", version = "0.13.0")
+crate.spec(package = "lazy_static", version = "1.5.0")
+crate.spec(package = "libm", version = "0.2.8")
+crate.spec(package = "lock_api", version = "0.4.12", features = ["arc_lock"])
+crate.spec(package = "log", version = "0.4.22")
+crate.spec(package = "mockall", version = "0.13.1")
+crate.spec(package = "nom", version = "8.0.0")
+crate.spec(package = "opentelemetry", version = "0.26.0", features = ["trace"])
+crate.spec(package = "opentelemetry-appender-tracing", version = "0.26.0", features = ["experimental_metadata_attributes"])
+crate.spec(package = "opentelemetry-otlp", version = "0.26.0", features = ["grpc-tonic", "logs", "metrics", "trace"])
+crate.spec(package = "opentelemetry_sdk", version = "0.26.0", features = ["logs", "metrics", "rt-tokio", "trace"])
+crate.spec(package = "nix", version = "0.27.1", features = ["fs", "mman", "mount", "process", "signal", "term", "ucontext", "user"])
+crate.spec(package = "procfs", version = "0.16.0")
+crate.spec(package = "primeorder", version = "0.13.6")
+crate.spec(package = "p256", version = "0.13.2")
+crate.spec(package = "p384", version = "0.13.0")
+crate.spec(package = "pkcs8", version = "0.10.2")
+crate.spec(package = "prost", version = "0.13.5")
+crate.spec(package = "prost-build", version = "0.13.5")
+crate.spec(package = "prost-derive", version = "0.13.5")
+crate.spec(package = "prost-types", version = "0.13.5")
+crate.spec(package = "quote", version = "1.0.44")
+crate.spec(package = "rand", version = "0.8.5")
+crate.spec(package = "rand_chacha", version = "0.3.1")
+crate.spec(package = "rand_core", version = "0.6.4")
+crate.spec(package = "regex-lite", version = "0.1.6")
+crate.spec(package = "rlsf", version = "0.2.1")
+crate.spec(package = "rsa", version = "0.9.8")
+crate.spec(package = "serde", version = "1.0.228")
+crate.spec(package = "serde_json", version = "1.0.145")
+crate.spec(package = "serde_yaml", version = "0.9.34")
+crate.spec(package = "slog", version = "2.8.2")
+crate.spec(package = "slog-term", version = "2.9.2")
+crate.spec(package = "static_assertions", version = "1.1.0")
+crate.spec(package = "sha2", version = "0.10.9")
+crate.spec(package = "spin", version = "0.9.8")
+crate.spec(package = "spinning_top", version = "0.3.0")
+crate.spec(package = "strum", version = "0.26.3", features = ["derive"])
+crate.spec(package = "strum_macros", version = "0.25.3")
+crate.spec(package = "syn", version = "2.0.114", features = ["full"])
+crate.spec(package = "test-log", version = "0.2.19")
+crate.spec(package = "time-macros", version = "<0.2.26")
+crate.spec(package = "tracing-subscriber", version = "0.3.22")
+crate.spec(package = "tokio", version = "1.46.1", features = ["fs", "io-std", "io-util", "macros", "net", "parking_lot", "process", "rt", "rt-multi-thread", "signal", "sync", "time"])
+crate.spec(package = "tokio-stream", version = "0.1.17", features = ["net"])
+crate.spec(package = "tokio-util", version = "0.7.13", features = ["rt"])
+crate.spec(package = "tonic", version = "0.12.3", features = ["gzip"])
+crate.spec(package = "tonic-build", version = "0.12.3")
+crate.spec(package = "tower", version = "0.4.13")
+crate.spec(package = "tracing", version = "0.1.44")
+crate.spec(package = "tracing-slog", version = "0.3.0")
+crate.spec(package = "thiserror", version = "2.0.12")
+crate.spec(package = "x509-cert", version = "0.2.5")
+crate.spec(package = "zerocopy", version = "0.8.26")
+crate.spec(package = "zeroize", version = "1.8.1", features = ["derive"])
+crate.from_specs(
+    name = "oak_crates_index",
+    host_tools = "@rust_host_tools_nightly",
+)
+use_repo(crate, "oak_crates_index")
+
+rust_host_tools = use_extension("@rules_rust//rust:extensions.bzl", "rust_host_tools")
+use_repo(rust_host_tools, "rust_host_tools_nightly")
+
